<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="MassWateR">
<title>MassWateR quality control functions • MassWateR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="MassWateR quality control functions">
<meta property="og:description" content="MassWateR">
<meta property="og:image" content="https://massbays-tech.github.io/MassWateR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MassWateR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9002</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/datainput.html">MassWateR data input and checks</a>
    <a class="dropdown-item" href="../articles/qcoverview.html">MassWateR quality control functions</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/massbays-tech/MassWateR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="qcoverview_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>MassWateR quality control functions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/massbays-tech/MassWateR/blob/HEAD/vignettes/qcoverview.Rmd" class="external-link"><code>vignettes/qcoverview.Rmd</code></a></small>
      <div class="d-none name"><code>qcoverview.Rmd</code></div>
    </div>

    
    
<p>The quality control functions in MassWateR can be used once the required data are successfully imported into R (see the <a href="https://massbays-tech.github.io/MassWateR/articles/datainput.html">previous vignette</a> for an overview). The required data includes the results data file that describe the monitoring data and the data quality objective files for completeness and accuracy. The example data files included with the package are imported here to demonstrate how to use the quality control functions:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/massbays-tech/MassWateR" class="external-link">MassWateR</a></span><span class="op">)</span>

<span class="co"># import results data</span>
<span class="va">respth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/ExampleResults_final.xlsx'</span>, package <span class="op">=</span> <span class="st">'MassWateR'</span><span class="op">)</span>
<span class="va">resdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_results.html">read_results</a></span><span class="op">(</span><span class="va">respth</span><span class="op">)</span>
<span class="co">#&gt; Running checks on results data...</span>
<span class="co">#&gt;  Checking column names... OK</span>
<span class="co">#&gt;  Checking all required columns are present... OK</span>
<span class="co">#&gt;  Checking valid Activity Types... OK</span>
<span class="co">#&gt;  Checking Activity Start Date formats... OK</span>
<span class="co">#&gt;  Checking Activity Start Time formats... OK</span>
<span class="co">#&gt;  Checking Relative Depth Category formats... OK</span>
<span class="co">#&gt;  Checking Characteristic Name formats... OK</span>
<span class="co">#&gt;  Checking Result Values... OK</span>
<span class="co">#&gt;  Checking QC Reference Values... OK</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; All checks passed!</span>

<span class="co"># import data quality objectives for accuracy</span>
<span class="va">dqoaccpth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/ExampleDQOAccuracy_final.xlsx'</span>, package <span class="op">=</span> <span class="st">'MassWateR'</span><span class="op">)</span>
<span class="va">dqoaccdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_dqoaccuracy.html">read_dqoaccuracy</a></span><span class="op">(</span><span class="va">dqoaccpth</span><span class="op">)</span>
<span class="co">#&gt; Running checks on data quality objectives for accuracy...</span>
<span class="co">#&gt;  Checking column names... OK</span>
<span class="co">#&gt;  Checking all required columns are present... OK</span>
<span class="co">#&gt;  Checking for non-numeric values in MDL, UQL... OK</span>
<span class="co">#&gt;  Checking for text other than &lt;=, &lt;, &gt;=, &gt;, ±, %, AQL, BQL, log, or all... OK</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; All checks passed!</span>

<span class="co"># import data quality objectives for completeness</span>
<span class="va">dqocompth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata/ExampleDQOCompleteness_final.xlsx'</span>, package <span class="op">=</span> <span class="st">'MassWateR'</span><span class="op">)</span>
<span class="va">dqocomdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_dqocompleteness.html">read_dqocompleteness</a></span><span class="op">(</span><span class="va">dqocompth</span><span class="op">)</span>
<span class="co">#&gt; Running checks on data quality objectives for completeness...</span>
<span class="co">#&gt;  Checking column names... OK</span>
<span class="co">#&gt;  Checking all required columns are present... OK</span>
<span class="co">#&gt;  Checking for non-numeric values... OK</span>
<span class="co">#&gt;  Checking for values outside of 0 and 100... OK</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; All checks passed!</span></code></pre></div>
<div class="section level2">
<h2 id="quality-control-for-accuracy">Quality control for accuracy<a class="anchor" aria-label="anchor" href="#quality-control-for-accuracy"></a>
</h2>
</div>
<div class="section level2">
<h2 id="quality-control-for-completeness">Quality control for completeness<a class="anchor" aria-label="anchor" href="#quality-control-for-completeness"></a>
</h2>
<p>The quality control checks for completeness are used to verify an appropriate number of quality control samples have been collected or analyzed for each parameter. These are checks on the quantity of samples and not the values, as for the accuracy checks.</p>
<p>The completeness checks require results data (as in <code>resdat</code> above) and a data quality objectives file for completeness (as in <code>dqocomdat</code>). The core function that assesses completeness is <code><a href="../reference/qc_completeness.html">qc_completeness()</a></code>. This function creates the raw summaries of completeness from the input data. Output from this function is used to create the formatted tables for reporting. Typically, <code><a href="../reference/qc_completeness.html">qc_completeness()</a></code> is not used by itself because it is used internally in other functions to create the tables. It is explained here to demonstrate the raw summaries that can be obtained, if desired.</p>
<p>The <code><a href="../reference/qc_completeness.html">qc_completeness()</a></code> function can be used with inputs as paths to the relevant files or as data frames returned by <code><a href="../reference/read_results.html">read_results()</a></code> and <code><a href="../reference/read_dqocompleteness.html">read_dqocompleteness()</a></code>. For the former, the full suite of data checks can be evaluated with <code>runkchk = T</code> (default) or suppressed with <code>runchk = F</code>, as explained in the <a href="https://massbays-tech.github.io/MassWateR/articles/datainput.html">data inputs and checks vignette</a>. In the latter case, downstream analyses may not work if data are formatted incorrectly. Also note that completeness is only evaluated on parameters in the <code>Parameter</code> column in the data quality objectives completeness file. A warning is returned if there are parameters in that column that are not found in the results file. This warning can be suppressed by setting <code>warn = FALSE</code> in <code><a href="../reference/qc_completeness.html">qc_completeness()</a></code>.</p>
<p>Below, the <code><a href="../reference/qc_completeness.html">qc_completeness()</a></code> function is executed with the data frames for the results and quality objectives file for completeness. Note that a warning message is returned indicating that the parameter <code>Chloride</code> was found in the data quality objectives file, but was not found in the results data. Completeness checks are done only on parameters that are shared between the two.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qc_completeness.html">qc_completeness</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, dqocom <span class="op">=</span> <span class="va">dqocomdat</span><span class="op">)</span>
<span class="co">#&gt; Warning in qc_completeness(res = resdat, dqocom = dqocomdat): Parameters in</span>
<span class="co">#&gt; quality control objectives for completeness not found in results data: Chloride</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 66 × 7</span></span>
<span class="co">#&gt;    Parameter          obs check                count standard percent met  </span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> chlorophyll a       18 Field Duplicate          0       10       0 FALSE</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> chlorophyll a       18 Lab Duplicate            0        5       0 FALSE</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> chlorophyll a       18 Field Blank              0       10       0 FALSE</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> chlorophyll a       18 Lab Blank                0        5       0 FALSE</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> chlorophyll a       18 Spike/Check Accuracy     0        5       0 FALSE</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> chlorophyll a       18 % Completeness          18       90     100 TRUE </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> DO concentration   199 Field Duplicate          0       10       0 FALSE</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> DO concentration   199 Lab Duplicate            0       10       0 FALSE</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> DO concentration   199 Field Blank              0       <span style="color: #BB0000;">NA</span>       0 <span style="color: #BB0000;">NA</span>   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> DO concentration   199 Lab Blank                0       10       0 FALSE</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 56 more rows</span></span></code></pre></div>
<p>The output shows the completeness checks from the combined files in long format. Each row applies to a specific completeness check for a parameter. The total observations (<code>obs</code>) for each parameter are also shown, which is repeated for a parameter across the rows to calculate percentages. The <code>check</code> column shows the relevant activity type that is assessed for completeness, the <code>count</code> columns shows the number of observations that apply to the check, the <code>standard</code> shows the relevant percentage required for quality control check from the quality control objectives file, the <code>percent</code> column shows the calculated percent taken from the input data, and the <code>met</code> column shows if the standard was met by comparing if <code>percent</code> is greater than or equal to <code>standard</code>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Marcus Beck, Jill Carr, Ben Wetherill, Pam DiBona.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
