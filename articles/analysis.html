<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="MassWateR">
<title>MassWateR analyses • MassWateR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="MassWateR analyses">
<meta property="og:description" content="MassWateR">
<meta property="og:image" content="https://massbays-tech.github.io/MassWateR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MassWateR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/MassWateR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/inputs.html">MassWateR data input and checks</a>
    <a class="dropdown-item" href="../articles/outlierchecks.html">MassWateR outlier checks</a>
    <a class="dropdown-item" href="../articles/qcoverview.html">MassWateR quality control functions</a>
    <a class="dropdown-item" href="../articles/analysis.html">MassWateR analyses</a>
    <a class="dropdown-item" href="../articles/utility.html">MassWateR utility functions</a>
    <a class="dropdown-item" href="../articles/modifying.html">Modifying plots</a>
    <a class="dropdown-item" href="../articles/wqx.html">Water Quality Exchange output</a>
    <a class="dropdown-item" href="../articles/outofstate.html">Out of state?</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../RESOURCES.html">Resources</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/massbays-tech/MassWateR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>MassWateR analyses</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/massbays-tech/MassWateR/blob/HEAD/vignettes/analysis.Rmd" class="external-link"><code>vignettes/analysis.Rmd</code></a></small>
      <div class="d-none name"><code>analysis.Rmd</code></div>
    </div>

    
    
<p>The analysis functions in MassWateR can be used to evaluate trends,
summaries, and maps once the required data are successfully imported
into R (see the <a href="https://massbays-tech.github.io/MassWateR/articles/inputs.html">data
input and checks vignette</a> for an overview). The results data file
with the monitoring data is required. The data quality objectives file
for accuracy is also required to automatically determine plot axis
scaling as arithmetic (linear) or logarithmic and to fill results data
that are below detection or above quantitation limits. The site metadata
file is used to create maps. The example data included with the package
are imported here to demonstrate how to use the analysis functions:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">MassWateR</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># import results data</span></span>
<span><span class="va">respth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/ExampleResults.xlsx"</span>, package <span class="op">=</span> <span class="st">"MassWateR"</span><span class="op">)</span></span>
<span><span class="va">resdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readMWRresults.html">readMWRresults</a></span><span class="op">(</span><span class="va">respth</span><span class="op">)</span></span>
<span><span class="co">#&gt; Running checks on results data...</span></span>
<span><span class="co">#&gt;  Checking column names... OK</span></span>
<span><span class="co">#&gt;  Checking all required columns are present... OK</span></span>
<span><span class="co">#&gt;  Checking valid Activity Types... OK</span></span>
<span><span class="co">#&gt;  Checking Activity Start Date formats... OK</span></span>
<span><span class="co">#&gt;  Checking depth data present... OK</span></span>
<span><span class="co">#&gt;  Checking for non-numeric values in Activity Depth/Height Measure... OK</span></span>
<span><span class="co">#&gt;  Checking Activity Depth/Height Unit... OK</span></span>
<span><span class="co">#&gt;  Checking Activity Relative Depth Name formats... OK</span></span>
<span><span class="co">#&gt;  Checking values in Activity Depth/Height Measure &gt; 1 m / 3.3 ft... OK</span></span>
<span><span class="co">#&gt;  Checking Characteristic Name formats... OK</span></span>
<span><span class="co">#&gt;  Checking Result Values... OK</span></span>
<span><span class="co">#&gt;  Checking for non-numeric values in Quantitation Limit... OK</span></span>
<span><span class="co">#&gt;  Checking QC Reference Values... OK</span></span>
<span><span class="co">#&gt;  Checking for missing entries for Result Unit... OK</span></span>
<span><span class="co">#&gt;  Checking if more than one unit per Characteristic Name... OK</span></span>
<span><span class="co">#&gt;  Checking acceptable units for each entry in Characteristic Name... OK</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All checks passed!</span></span>
<span></span>
<span><span class="co"># import accuracy data</span></span>
<span><span class="va">accpth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/ExampleDQOAccuracy.xlsx"</span>, package <span class="op">=</span> <span class="st">"MassWateR"</span><span class="op">)</span></span>
<span><span class="va">accdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readMWRacc.html">readMWRacc</a></span><span class="op">(</span><span class="va">accpth</span><span class="op">)</span></span>
<span><span class="co">#&gt; Running checks on data quality objectives for accuracy...</span></span>
<span><span class="co">#&gt;  Checking column names... OK</span></span>
<span><span class="co">#&gt;  Checking all required columns are present... OK</span></span>
<span><span class="co">#&gt;  Checking column types... OK</span></span>
<span><span class="co">#&gt;  Checking no "na" in Value Range... OK</span></span>
<span><span class="co">#&gt;  Checking for text other than &lt;=, ≤, &lt;, &gt;=, ≥, &gt;, ±, %, AQL, BQL, log, or all... OK</span></span>
<span><span class="co">#&gt;  Checking overlaps in Value Range... OK</span></span>
<span><span class="co">#&gt;  Checking gaps in Value Range... OK</span></span>
<span><span class="co">#&gt;  Checking Parameter formats... OK</span></span>
<span><span class="co">#&gt;  Checking for missing entries for unit (uom)... OK</span></span>
<span><span class="co">#&gt;  Checking if more than one unit (uom) per Parameter... OK</span></span>
<span><span class="co">#&gt;  Checking acceptable units (uom) for each entry in Parameter... OK</span></span>
<span><span class="co">#&gt;  Checking empty columns... OK</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All checks passed!</span></span>
<span></span>
<span><span class="co"># import site metadata</span></span>
<span><span class="va">sitpth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/ExampleSites.xlsx"</span>, package <span class="op">=</span> <span class="st">"MassWateR"</span><span class="op">)</span></span>
<span><span class="va">sitdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readMWRsites.html">readMWRsites</a></span><span class="op">(</span><span class="va">sitpth</span><span class="op">)</span></span>
<span><span class="co">#&gt; Running checks on site metadata...</span></span>
<span><span class="co">#&gt;  Checking column names... OK</span></span>
<span><span class="co">#&gt;  Checking all required columns are present... OK</span></span>
<span><span class="co">#&gt;  Checking for missing latitude or longitude values... OK</span></span>
<span><span class="co">#&gt;  Checking for non-numeric values in latitude... OK</span></span>
<span><span class="co">#&gt;  Checking for non-numeric values in longitude... OK</span></span>
<span><span class="co">#&gt;  Checking for positive values in longitude... OK</span></span>
<span><span class="co">#&gt;  Checking for missing entries for Monitoring Location ID... OK</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; All checks passed!</span></span></code></pre></div>
<div class="section level2">
<h2 id="analyze-seasonal-trends">Analyze seasonal trends<a class="anchor" aria-label="anchor" href="#analyze-seasonal-trends"></a>
</h2>
<p>Seasonal trends can be evaluated using the
<code><a href="../reference/anlzMWRseason.html">anlzMWRseason()</a></code> function. This function summarizes results
for a single parameter using boxplots or barplots with seasonal groups
assigned to months or weeks of the year. Boxplots or barplots can also
include jittered points of the observations on top or only the jittered
points can be shown. Threshold lines are also shown on the plot to
determine if results are near thresholds of interest. The data that are
plotted can be filtered by sites, dates, result attributes, or location
groups (from the site metadata file).</p>
<p>The <code><a href="../reference/anlzMWRseason.html">anlzMWRseason()</a></code> function uses the results data as a
file path or data frame as input. The input files are passed to the
function using the <code>res</code> and <code>acc</code> arguments, but
a named list with the same arguments can also be used with the
<code>fset</code> argument for convenience. Below, the results for
dissolved oxygen (<code>param = "DO"</code>) are grouped by month using
<code>group = "month"</code> and as boxplots using
<code>type = "box"</code>. A description of the summary statistics shown
by a boxplot is provided in the <a href="https://massbays-tech.github.io/MassWateR/articles/outlierchecks.html#analyzing-outliers">outlier
checks</a> vignette. The relevant threshold lines for freshwater
environments are shown using <code>thresh = "fresh"</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRseason.html">anlzMWRseason</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, group <span class="op">=</span> <span class="st">"month"</span>, type <span class="op">=</span> <span class="st">"box"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-3-1.png" width="768"></p>
<p>Jittered points over the boxplots can be shown by setting
<code>type = "jitterbox"</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRseason.html">anlzMWRseason</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, group <span class="op">=</span> <span class="st">"month"</span>, type <span class="op">=</span> <span class="st">"jitterbox"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-4-1.png" width="768"></p>
<p>The same data can also be grouped by week using
<code>group = "week"</code>. The week of the year is shown on the plot
as an integer. Note that there can be no common month/day indicating the
start of the week between years and an integer is the only way to
compare summaries if the results data span multiple years.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRseason.html">anlzMWRseason</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, group <span class="op">=</span> <span class="st">"week"</span>, type <span class="op">=</span> <span class="st">"box"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-5-1.png" width="768"></p>
<p>Barplots can be shown using <code>type = "bar"</code>. The barplots
show the average estimate for the results defined by the
<code>group</code> argument.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRseason.html">anlzMWRseason</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, group <span class="op">=</span> <span class="st">"month"</span>, type <span class="op">=</span> <span class="st">"bar"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-6-1.png" width="768"></p>
<p>Confidence intervals at 95% for the barplots can be shown by setting
<code>confint = TRUE</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRseason.html">anlzMWRseason</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, group <span class="op">=</span> <span class="st">"month"</span>, type <span class="op">=</span> <span class="st">"bar"</span>, confint <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-7-1.png" width="768"></p>
<p>Jittered points over the barplots can be shown by setting
<code>type = "jitterbar"</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRseason.html">anlzMWRseason</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, group <span class="op">=</span> <span class="st">"month"</span>, type <span class="op">=</span> <span class="st">"jitterbar"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-8-1.png" width="768"></p>
<p>Setting <code>type = "jitter"</code> will show only the jittered
points.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRseason.html">anlzMWRseason</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, group <span class="op">=</span> <span class="st">"month"</span>, type <span class="op">=</span> <span class="st">"jitter"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-9-1.png" width="768"></p>
<p>The threshold lines shown on each plot are determined from the
<code>thresholdMWR</code> file included with MassWateR. These threshold
lines describe relevant state standards or typical ranges in
Massachusetts, if applicable for a parameter. Thresholds can be plotted
for freshwater or marine environments using the <code>thresh</code>
argument as <code>thresh = "fresh"</code> or
<code>thresh = "marine"</code>, respectively. Two threshold lines are
typically shown, whereas some parameters may only have one threshold
line. Other parameters have no information in the
<code>thresholdMWR</code> file and lines will not be plotted. Threshold
lines can be suppressed by setting <code>thresh = "none"</code>. Below,
the marine thresholds are shown for dissolved oxygen using the barplot
option grouped by month.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRseason.html">anlzMWRseason</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"marine"</span>, group <span class="op">=</span> <span class="st">"month"</span>, type <span class="op">=</span> <span class="st">"bar"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-10-1.png" width="768"></p>
<p>A user-supplied numeric value can also be used for the
<code>thresh</code> argument. The <code>threshlab</code> argument must
also be used to label the custom threshold in the plot legend.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRseason.html">anlzMWRseason</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="fl">8</span>, threshlab <span class="op">=</span> <span class="st">"Custom threshold"</span>, group <span class="op">=</span> <span class="st">"month"</span>, type <span class="op">=</span> <span class="st">"bar"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-11-1.png" width="768"></p>
<p>The y-axis scaling as arithmetic (linear) or logarithmic can be set
with the <code>yscl</code> argument. If <code>yscl = "auto"</code>
(default), the scaling is determined automatically from the data quality
objective file for accuracy, i.e., parameters with “log” in any of the
columns are plotted on log10-scale, otherwise arithmetic. Setting
<code>yscl = "linear"</code> or <code>yscl = "log"</code> will set the
axis as linear or log10-scale, respectively, regardless of the
information in the data quality objective file for accuracy. Below, the
axis for E. Coli is plotted on the log-10 scale automatically. The
y-axis scaling does not need to specified explicitly in the function
call because the default setting is <code>yscl = "auto"</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRseason.html">anlzMWRseason</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"E.coli"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, group <span class="op">=</span> <span class="st">"month"</span>, type <span class="op">=</span> <span class="st">"bar"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-12-1.png" width="768"></p>
<p>To force the y-axis as linear for E. Coli,
<code>yscl = "linear"</code> must be used. Note that the default linear
scaling for dissolved oxygen above is determined automatically. The
means and confidence intervals will also vary between arithmetic and
log-scaling if <code>type = "bar"</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRseason.html">anlzMWRseason</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"E.coli"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, group <span class="op">=</span> <span class="st">"month"</span>, type <span class="op">=</span> <span class="st">"bar"</span>, yscl <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-13-1.png" width="768"></p>
<p>If <code>type</code> is <code>"bar"</code> or
<code>"jitterbar"</code>, the data will be summarized using the mean or
geometric mean as appropriate for the parameter based on information in
the data quality objective file for accuracy. By default, the summary is
based on the <code>yscl</code> argument. The default can be changed by
passing a value to the <code>sumfun</code> argument, where appropriate
values include <code>"auto"</code> (automatically as mean or geometric
mean using information in the data quality objective file for accuracy),
<code>"mean"</code>, <code>"geomean"</code>, <code>"median"</code>,
<code>"min"</code>, or <code>"max"</code>. Confidence intervals will be
included if <code>confint = TRUE</code> and the summary is automatic or
the mean or geometric mean is used to override the automatic summary.
Below, the median summary is shown for E. coli.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRseason.html">anlzMWRseason</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"E.coli"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, group <span class="op">=</span> <span class="st">"month"</span>, type <span class="op">=</span> <span class="st">"bar"</span>, sumfun <span class="op">=</span> <span class="st">"median"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-14-1.png" width="768"></p>
<p>Results can also be filtered by dates using the <code>dtrng</code>
argument. The date format must be <code>YYYY-MM-DD</code> and include
two entries.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRseason.html">anlzMWRseason</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"E.coli"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, group <span class="op">=</span> <span class="st">"month"</span>, type <span class="op">=</span> <span class="st">"bar"</span>, dtrng <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2022-05-01"</span>, <span class="st">"2022-07-31"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-15-1.png" width="768"></p>
<p>Finally, the results can be filtered by sites, result attributes, and
location groups using the <code>site</code>, <code>resultatt</code>, and
<code>locgroup</code> arguments. These options will filter the results
data based on values in the <code>Monitoring Location ID</code> and
<code>Result Attribute</code> columns in the results file and by the
<code>Location Group</code> column in the site metadata file, which must
be provided to the <code>sit</code> argument if <code>locgroup</code> is
used.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRseason.html">anlzMWRseason</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, sit <span class="op">=</span> <span class="va">sitdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, group <span class="op">=</span> <span class="st">"month"</span>, site <span class="op">=</span> <span class="st">"ABT-077"</span>, resultatt <span class="op">=</span> <span class="st">"DRY"</span>, locgroup <span class="op">=</span> <span class="st">"Assabet"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-16-1.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="analyze-trends-by-date">Analyze trends by date<a class="anchor" aria-label="anchor" href="#analyze-trends-by-date"></a>
</h2>
<p>Trends by date for selected parameters can be evaluated using the
<code><a href="../reference/anlzMWRdate.html">anlzMWRdate()</a></code> function. The plot shows results continuously
over time as line plots, with the lines separated by site, combined
across sites, or combined across location groups. For location groups,
the site metadata file must be supplied. Many of the options described
for the <code><a href="../reference/anlzMWRseason.html">anlzMWRseason()</a></code> function also apply and will not be
repeated here. As before, the required data are a results file and data
quality objective file for accuracy. These can be passed to the function
with the separate arguments or as a named list using the
<code>fset</code> argument.</p>
<p>The default plot for <code><a href="../reference/anlzMWRdate.html">anlzMWRdate()</a></code> will show separate
lines for each site, y-axis scaling determined automatically from the
data quality objectives file, and site labels at the end of each line.
All sites in the results file will be plotted, which can be difficult to
visualize. Selecting specific sites with the <code>site</code> argument
is recommended.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRdate.html">anlzMWRdate</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, group <span class="op">=</span> <span class="st">"site"</span>, site <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ABT-026"</span>, <span class="st">"ABT-077"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-17-1.png" width="768"></p>
<p>A color legend for the sites can be included by setting
<code>colleg = TRUE</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRdate.html">anlzMWRdate</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, group <span class="op">=</span> <span class="st">"site"</span>, site <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ABT-026"</span>, <span class="st">"ABT-077"</span><span class="op">)</span>,</span>
<span>            colleg <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-18-1.png" width="768"></p>
<p>The color palette for the site points and lines can also be changed.
Any palette from <a href="https://r-graph-gallery.com/38-rcolorbrewers-palettes.html" target="_blank" class="external-link">RColorBrewer</a> can be used. These could include any of
the qualitative color palettes, e.g., <code>"Set1"</code>,
<code>"Set2"</code>, etc. The continuous and diverging palettes will
also work, but may return color scales for points and lines that are
difficult to distinguish. The <code>palcol</code> argument does not
apply if <code>group = "all"</code>. In the following example, the
qualitative <code>"Set1"</code> palette is used.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRdate.html">anlzMWRdate</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, group <span class="op">=</span> <span class="st">"site"</span>, site <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ABT-026"</span>, <span class="st">"ABT-077"</span><span class="op">)</span>, palcol <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-19-1.png" width="768"></p>
<p>The results averaged across the selected sites can be plotted using
<code>group = "all"</code>. The point and line color defaults to
black.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRdate.html">anlzMWRdate</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, group <span class="op">=</span> <span class="st">"all"</span>, site <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ABT-026"</span>, <span class="st">"ABT-077"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-20-1.png" width="768"></p>
<p>The results averaged across all sites in the results file can be
plotted by omitting the <code>site</code> argument.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRdate.html">anlzMWRdate</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, group <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-21-1.png" width="768"></p>
<p>Confidence intervals at 95% for the points can be shown when
<code>group = "all"</code> or <code>"locgroup"</code> by setting
<code>confint = TRUE</code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRdate.html">anlzMWRdate</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, group <span class="op">=</span> <span class="st">"all"</span>, confint <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-22-1.png" width="768"></p>
<p>Sites can be summarized across location groups using
<code>group = "locgroup"</code>. This option requires the site metadata
file passed to the <code>sit</code> argument and appropriate values for
the location groups passed to the <code>locgroup</code> argument that
match values in the <code>Location Group</code> column of the site
metadata file.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRdate.html">anlzMWRdate</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">'DO'</span>, acc <span class="op">=</span> <span class="va">accdat</span>, sit <span class="op">=</span> <span class="va">sitdat</span>, group <span class="op">=</span> <span class="st">'locgroup'</span>, </span>
<span>      thresh <span class="op">=</span> <span class="st">'fresh'</span>, locgroup <span class="op">=</span> <span class="st">'Assabet'</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-23-1.png" width="768"></p>
<p>All location groups can be used if the <code>locgroup</code> argument
is omitted.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRdate.html">anlzMWRdate</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">'DO'</span>, acc <span class="op">=</span> <span class="va">accdat</span>, sit <span class="op">=</span> <span class="va">sitdat</span>, group <span class="op">=</span> <span class="st">'locgroup'</span>, </span>
<span>      thresh <span class="op">=</span> <span class="st">'fresh'</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-24-1.png" width="768"></p>
<p>Alternative summaries can also be used if <code>group = "all"</code>
or <code>"locgroup"</code> by using an appropriate value for the
<code>sumfun</code> argument. By default, the <code>sumfun</code>
argument is based on the value passed to <code>yscl</code>, i.e.,
automatic summaries (<code>yscl = "auto"</code>) as mean or geometric
mean based on information in the data quality objective file for
accuracy or using mean or geometric regardless of the accuracy file
(<code>yscl = "linear"</code> or <code>yscl = "log"</code>). Using any
appropriate value for the <code>sumfun</code> argument will override any
value used for the <code>yscl</code> argument. Options for
<code>sumfun</code> include <code>"auto"</code> (automatically as mean
or geometric mean using information in the data quality objective file
for accuracy), <code>"mean"</code>, <code>"geomean"</code>,
<code>"median"</code>, <code>"min"</code>, or <code>"max"</code>. Below,
the median is used to summarize results by location group.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRdate.html">anlzMWRdate</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">'DO'</span>, acc <span class="op">=</span> <span class="va">accdat</span>, sit <span class="op">=</span> <span class="va">sitdat</span>, group <span class="op">=</span> <span class="st">'locgroup'</span>, </span>
<span>      thresh <span class="op">=</span> <span class="st">'fresh'</span>, sumfun <span class="op">=</span> <span class="st">'median'</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-25-1.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="analyze-data-by-site">Analyze data by site<a class="anchor" aria-label="anchor" href="#analyze-data-by-site"></a>
</h2>
<p>Result data by site for selected parameters can be evaluated using
the <code><a href="../reference/anlzMWRsite.html">anlzMWRsite()</a></code> function. This function summarizes
results for a single parameter using boxplots or barplots separately for
each site on the x-axis. Boxplots or barplots can also include jittered
points of the observations on top or only the jittered points can be
shown. Many of the options described for the
<code><a href="../reference/anlzMWRseason.html">anlzMWRseason()</a></code> function also apply and will not be
repeated here. As before, the required data are a results file and data
quality objective file for accuracy. These can be passed to the function
with the separate arguments or as a named list using the
<code>fset</code> argument.</p>
<p>The default plot for <code><a href="../reference/anlzMWRsite.html">anlzMWRsite()</a></code> will show boxplots of
results for each site and y-axis scaling determined automatically from
the data quality objectives file.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRsite.html">anlzMWRsite</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, type <span class="op">=</span> <span class="st">"box"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-26-1.png" width="768"></p>
<p>Jittered points over the boxplots can be shown by setting
<code>type = "jitterbox"</code>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRsite.html">anlzMWRsite</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, type <span class="op">=</span> <span class="st">"jitterbox"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-27-1.png" width="768"></p>
<p>Results as barplots can be shown using <code>type = "bar"</code>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRsite.html">anlzMWRsite</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, type <span class="op">=</span> <span class="st">"bar"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-28-1.png" width="768"></p>
<p>Confidence intervals at 95% for the barplots can be shown by setting
<code>confint = TRUE</code>.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRsite.html">anlzMWRsite</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, type <span class="op">=</span> <span class="st">"bar"</span>, confint <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-29-1.png" width="768"></p>
<p>Jittered points over the barplots can be shown by setting
<code>type = "jitterbar"</code>.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRsite.html">anlzMWRsite</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, type <span class="op">=</span> <span class="st">"jitterbar"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-30-1.png" width="768"></p>
<p>Setting <code>type = "jitter"</code> will show only the jittered
points.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRsite.html">anlzMWRsite</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, type <span class="op">=</span> <span class="st">"jitter"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-31-1.png" width="768"></p>
<p>If <code>type</code> is <code>"bar"</code> or
<code>"jitterbar"</code>, the data will be summarized using the mean or
geometric mean as appropriate for the parameter based on information in
the data quality objective file for accuracy. By default, the summary is
based on the <code>yscl</code> argument. The default can be changed by
passing a value to the <code>sumfun</code> argument, where appropriate
values include <code>"auto"</code> (automatically as mean or geometric
mean using information in the data quality objective file for accuracy),
<code>"mean"</code>, <code>"geomean"</code>, <code>"median"</code>,
<code>"min"</code>, or <code>"max"</code>. Below, the median summary is
shown.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRsite.html">anlzMWRsite</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, type <span class="op">=</span> <span class="st">"jitterbar"</span>, </span>
<span>            sumfun <span class="op">=</span> <span class="st">'median'</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-32-1.png" width="768"></p>
<p>Results can be grouped by entries in the <code>Result Atribute</code>
column using <code>byresultatt = TRUE</code>. For example, sites with DO
samples can be grouped by <code>"DRY"</code> or <code>"WET"</code>
conditions. Filtering by sites first using the <code>site</code>
argument is advised to reduce the amount of data that are plotted. The
grouping can be filtered further by passing appropriate values in the
<code>Result Attribute</code> column to the <code>resultatt</code>
argument. Note that specifying result attributes with
<code>resultatt</code> and setting <code>byresultatt = FALSE</code> will
filter the plot data by the result attributes but will not plot the
results separately.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRsite.html">anlzMWRsite</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, thresh <span class="op">=</span> <span class="st">"fresh"</span>, type <span class="op">=</span> <span class="st">"box"</span>, </span>
<span>                        site <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ABT-026"</span>, <span class="st">"ABT-062"</span>, <span class="st">"ABT-077"</span>, <span class="st">"ABT-144"</span>, <span class="st">"ABT-237"</span>, <span class="st">"ABT-301"</span><span class="op">)</span>,</span>
<span>                        resultatt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'DRY'</span>, <span class="st">'WET'</span><span class="op">)</span>, byresultatt <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-33-1.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="analyze-results-with-maps">Analyze results with maps<a class="anchor" aria-label="anchor" href="#analyze-results-with-maps"></a>
</h2>
<p>The <code><a href="../reference/anlzMWRmap.html">anlzMWRmap()</a></code> function can be used to create a map of
summarized results for a selected parameter at each monitoring site. By
default, all dates for the parameter are summarized as the mean or
geometric mean based on information in the data quality objective file
for accuracy. Options to filter by site, date range, and result
attribute are provided. Only sites with spatial information in the site
metadata file are plotted and a warning is returned for those that do
not have this information. The site labels are also plotted next to each
point.</p>
<p>A map of dissolved oxygen averages across all dates can be created as
follows. The required inputs are the results data, the data quality
objective file for accuracy, and the site metadata file with the site
locations. These can be passed to the function with the separate
arguments or as a named list using the <code>fset</code> argument.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRmap.html">anlzMWRmap</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, sit <span class="op">=</span> <span class="va">sitdat</span>, addwater <span class="op">=</span> <span class="st">"medium"</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-34-1.png" width="576"></p>
<p>The results shown on the map represent the parameter summary for each
site across the sample dates. If <code>sumfun = "auto"</code> (default),
the mean is used where the distribution is determined automatically from
the data quality objective file for accuracy, i.e., parameters with
“log” in any of the columns are summarized with the geometric mean,
otherwise arithmetic. Any other valid summary function will be applied
if passed to <code>sumfun</code> (<code>"mean"</code>,
<code>"geomean"</code>, <code>"median"</code>, <code>"min"</code>,
<code>"max"</code>), regardless of the information in the data quality
objective file for accuracy. Below, the minimum dissolved oxygen is
shown. The color palette is also reversed.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRmap.html">anlzMWRmap</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, sit <span class="op">=</span> <span class="va">sitdat</span>, addwater <span class="op">=</span> <span class="st">"medium"</span>, </span>
<span>           sumfun <span class="op">=</span> <span class="st">"min"</span>, palcolrev <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-35-1.png" width="576"></p>
<p>By default, lines and polygons of natural water bodies defined using
the National Hydrography Dataset (NHD) are plotted. Using
<code>addwater = "medium"</code> (default) will plot water bodies at
medium detail. The level of detail can be changed to low or high using
<code>addwater = "low"</code> or <code>addwater = "high"</code>,
respectively. Use <code>addwater = NULL</code> to not show any water
features.</p>
<p>Water body detail as low:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRmap.html">anlzMWRmap</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, sit <span class="op">=</span> <span class="va">sitdat</span>, addwater <span class="op">=</span> <span class="st">"low"</span>, warn <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-36-1.png" width="576"></p>
<p>Water body detail as high:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRmap.html">anlzMWRmap</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, sit <span class="op">=</span> <span class="va">sitdat</span>, addwater <span class="op">=</span> <span class="st">"high"</span>, warn <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-37-1.png" width="576"></p>
<p>A north arrow, scale bar, and labels are also plotted. These can be
suppressed by setting the appropriate arguments to
<code>NULL</code>.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRmap.html">anlzMWRmap</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, sit <span class="op">=</span> <span class="va">sitdat</span>, northloc <span class="op">=</span> <span class="cn">NULL</span>, scaleloc <span class="op">=</span> <span class="cn">NULL</span>, labsize <span class="op">=</span> <span class="cn">NULL</span>, warn <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-38-1.png" width="576"></p>
<p>Locations of the north arrow and scale bar can be changed with the
same arguments by specifying <code>"tl"</code>, <code>"tr"</code>,
<code>"bl"</code>, or <code>"br"</code> for top-left, top-right,
bottom-left, or bottom-right.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRmap.html">anlzMWRmap</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, sit <span class="op">=</span> <span class="va">sitdat</span>, northloc <span class="op">=</span> <span class="st">"br"</span>, scaleloc <span class="op">=</span> <span class="st">"tl"</span>, warn <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-39-1.png" width="576"></p>
<p>The latitude and longitude text on the plot axes can be suppressed
using <code>latlon = FALSE</code>.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRmap.html">anlzMWRmap</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, sit <span class="op">=</span> <span class="va">sitdat</span>, latlon <span class="op">=</span> <span class="cn">F</span>, warn <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-40-1.png" width="576"></p>
<p>The color palette for the average values can also be changed. Any
palette from <a href="https://r-graph-gallery.com/38-rcolorbrewers-palettes.html" target="_blank" class="external-link">RColorBrewer</a> can be used. These could include any of
the sequential color palettes, e.g., <code>"Greens"</code>,
<code>"Blues"</code>, etc. The diverging and qualitative palettes will
also work, but may return uninterpretable color scales. In the following
example, the diverging <code>"Spectral"</code> palette is used.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRmap.html">anlzMWRmap</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, sit <span class="op">=</span> <span class="va">sitdat</span>, palcol <span class="op">=</span> <span class="st">"Spectral"</span>, warn <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-41-1.png" width="576"></p>
<p>The buffered distance around the points can be increased using the
<code>buffdist</code> argument (in kilometers).</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRmap.html">anlzMWRmap</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, sit <span class="op">=</span> <span class="va">sitdat</span>, buffdist <span class="op">=</span> <span class="fl">20</span>, warn <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-42-1.png" width="672"></p>
<p>A base map can be included as well using the <code>maptype</code>
argument. Options include <code>"cartolight"</code>,
<code>"cartodark"</code>, <code>"osm"</code>, or
<code>"hotstyle"</code>. The <code>zoom</code> argument can be helpful
when using a basemap. The default <code>zoom</code> argument is set to
11 and decreasing the number will download a base map with lower
resolution. This can decrease map processing times for large areas.</p>
<p>A <code>"cartolight"</code> base map:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRmap.html">anlzMWRmap</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, sit <span class="op">=</span> <span class="va">sitdat</span>, maptype <span class="op">=</span> <span class="st">"cartolight"</span>, warn <span class="op">=</span> <span class="cn">F</span>, addwater <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-43-1.png" width="576"></p>
<p>A <code>"osm"</code> base map:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRmap.html">anlzMWRmap</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, sit <span class="op">=</span> <span class="va">sitdat</span>, maptype <span class="op">=</span> <span class="st">"osm"</span>, warn <span class="op">=</span> <span class="cn">F</span>, addwater <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-44-1.png" width="576"></p>
<p>A map with no base map or water bodies:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/anlzMWRmap.html">anlzMWRmap</a></span><span class="op">(</span>res <span class="op">=</span> <span class="va">resdat</span>, param <span class="op">=</span> <span class="st">"DO"</span>, acc <span class="op">=</span> <span class="va">accdat</span>, sit <span class="op">=</span> <span class="va">sitdat</span>, maptype <span class="op">=</span> <span class="cn">NULL</span>, warn <span class="op">=</span> <span class="cn">F</span>, addwater <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p><img src="analysis_files/figure-html/unnamed-chunk-45-1.png" width="576"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Marcus Beck, Jill Carr, Ben Wetherill.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
